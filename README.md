# Email-Spam-detection
Windows one-click email spam detector. Fetches mail via IMAP, trains a TF-IDF ensemble on INBOX+Spam, evaluates, then classifies INBOX only. Exports per-account CSV/TXT/XLSX and reusable artifacts, plus a utility to re-classify any saved Inbox_Mails file.

# Email-Spam-detection
Windows one-click email spam detector. Fetches mail via IMAP, trains a TF-IDF ensemble on INBOX+Spam, evaluates, then classifies INBOX only (no cheating). Exports per-account CSV/TXT/XLSX and reusable artifacts, plus a utility to re-classify any saved Inbox_Mails file.

1) What you’ll need
Python 3.10+ in PATH (python --version)
Gmail App Password (since IMAP with 2FA needs it)
Google Account → Security → 2-Step Verification → App passwords → type “IMAP” → copy the 16-char password (no spaces).
IMAP enabled in Gmail (Settings → See all settings → Forwarding and POP/IMAP → Enable IMAP)

2) Get the code
# PowerShell or CMD
git clone <your-repo-url> EMAIL-SPAM
cd EMAIL-SPAM

3) First-time setup (creates venv + installs deps)

Option A — simplest (Windows)
Double-click start.bat (or run it from terminal):
start.bat
This will:
Create .venv
Install packages from requirements.txt
Launch one_click_plus_classify.py interactively

Option B — manual (any OS)
python -m venv .venv
.\.venv\Scripts\python.exe -m pip install --upgrade pip
.\.venv\Scripts\python.exe -m pip install -r requirements.txt

4) Run the one-click pipeline
.\.venv\Scripts\python.exe one_click_plus_classify.py
You’ll be asked:
IMAP host: imap.gmail.com
Inbox folder: INBOX
Spam folder: [Gmail]/Spam
Fetch limits: e.g., 50 / 50
Mailbox action: press Enter (skip)
Email for outputs: enter the same Gmail (used to name the output folder)
When prompted for email and App Password, paste both (16 chars, no spaces).
What happens:
Fetches INBOX (ham) + Spam (spam) → builds dataset.csv
Balances data → trains TF-IDF ensemble → saves artifacts_v2/
Evaluates (F1/ROC/CM) → Predicts on INBOX only
Writes clean reports to outputs/<your_email_bucket>/
Auto-classifies the freshly exported Inbox_Mails.* using the just-trained artifacts, writing:
Inbox_Mails_Classified.[csv|txt|xlsx]

5) Where to find your results
outputs/
  <your_email_bucket>/
    Inbox_Mails.[csv|txt|xlsx]
    Spam_Mails.[csv|txt|xlsx]
    Live_Predictions.[csv|txt|xlsx]
    Inbox_Mails_Classified.[csv|txt|xlsx]   ← final decisions (Spam / Not Spam)
runs/
  <timestamp>/
    data/… , artifacts_v2/… , artifacts/…
<your_email_bucket> is a safe folder name like bishwamoychowdhury_gmail_com.

6) Re-classify later (no IMAP, offline)
If you already have outputs and a trained model, you can classify again (e.g., after editing the CSV) without re-fetching or retraining:
.\.venv\Scripts\python.exe classify_inbox_file.py
Prompts:
  Artifacts folder: e.g., runs\2025-10-17_22-25-34\artifacts_v2
  Email (to locate outputs subfolder): your Gmail
  (Optional) Path to Inbox_Mails.[csv|xlsx|txt] (press Enter to auto-discover)

7) Multiple accounts (kept separate)
Each run asks “Save outputs under which email” → results go to a unique folder per account. Nothing gets overwritten across accounts.

8) Common fixes
AUTHENTICATIONFAILED: wrong email or App Password; ensure IMAP is enabled.
openpyxl missing: script auto-installs; CSV/TXT are still written regardless.
Model/vectorizer mismatch: the repo already uses the saved vectorizer from the same artifacts folder; always point classification to the artifacts generated by the one-click run that produced your outputs.

9) Notes
This is a batch workflow (fetch → train → evaluate → classify). No realtime listener in this streamlined setup.
The final threshold (from validation) is stored in threshold.json; higher threshold = fewer false positives.
This is a batch workflow (fetch → train → evaluate → classify). No realtime listener in this streamlined setup.

The final threshold (from validation) is stored in threshold.json; higher threshold = fewer false positives.
